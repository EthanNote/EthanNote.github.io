# Research Note: PILA

PILA: Sub-Meter Localization Using CSI from Commodity Wi-Fi Devices



PILA 是一种使用WiFi信号进行定位的系统，使用商用的WiFi设备建立无线连接，通过计算信号相对于接收天线的到达角度，以及测算信号的传播距离，对信号源的空间坐标进行估计。

测角方面，PILA采用了经典的MUSIC算法，并进行了一些改进。WiFi信号具有多径效应，信号从发射天线出发，经不同路径以极小的时间差到达接收天线，因此来自不同路径的信号彼此会产生干涉，影响角度测量结果。PILA通过对CSI数据做平滑处理消除干涉影响。

测距方面，PILA使用了信号强度的对数衰减模型，根据信号的衰减幅度来估算信号的传播距离。

PILA系统使用多个WiFi接入点对同一设备进行定位。使用多组角度、距离数据可以较好地消除测量误差，系统使用最优化方法，构造关于设备二维坐标的目标函数，通过求函数极小值点进行定位。为了构造凸优化问题，系统使用了二阶圆锥规划。

## 一、二维空间平滑处理

### 二维空间平滑算法

- 用于消除多径相干信号造成的干扰
- 在到达角度测量方面应用广泛
- 认为数据点的取值约等于附近区域数据的平均值，具有低通滤波特性

二维空间平滑可以理解为图像的模糊化处理，将矩阵的一部分区域取值设为该区域的平均值。当矩阵数据受到干扰因素影响，取值在真实值附近对称分布时，平滑处理能够很好地消除噪声干扰。

### CSI平滑处理

- 处理对象为MUSIC算法计算中所需的CSI协方差矩阵

- 划分子矩阵，求子矩阵平均值，由平均值构造新的协方差矩阵

MUSIC的计算公式包含了CSI协方差矩阵，PILA对该矩阵进行了平滑处理，由此计算MUSIC得到的结果消除了信号干涉的影响

## 二、直射路径识别

### 相位矫正

- 消除PDD带来的CSI相位误差
- PDD相位误差特点：随子载波序号增大相位偏差线性增加
- 使用一次函数拟合CSI相位，求出斜率和截距作为修正参数

包检测延迟使得无线信号在时域上发生偏移，经傅里叶变换后便体现为CSI复数的相位角发生偏移。同一个PDD下，不同频率子载波的CSI相位角偏移大小是不同的，频率越高，偏移越大，偏移幅度是子载波序号的一次函数

### 高斯均值聚类

- 使用聚类方法区分多径
- 划分出若干个聚类，每个聚类中的点都服从高斯分布
- 由各个聚类的参数（点个数，AOA方差， TOA方差）计算直射路径相似度

PILA使用MUSIC算法得出信号的AOA和TOA， 然后判断该信号是否为直射路径信号。将AOA和TOA构成二维坐标，同一路径上信号对应的坐标点会集中分布在某个区域，并呈现高斯分布。不同路径上信号对应的点会明显分离。通过收集较多的数据，划分多个高斯分布，即可区分不同的路径，并识别出直射路径

## 三、定位

- 使用信号强度计算得出的距离作为辅助约束
- 使用优化方法求目标位置，由多组距离和方向角的测量数据构造优化目标函数
- 原函数非凸， 进行变量代换，使用二阶锥规划求解
